(this["webpackJsonpaks-deploy-guide2"]=this["webpackJsonpaks-deploy-guide2"]||[]).push([[0],{101:function(e,t,n){e.exports=n(107)},106:function(e,t,n){},107:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(45),s=n.n(o),i=(n(106),n(17)),l=n(27),c=n(185),u=n(192),d=n(196),p=n(179),m=n(52),g=n(188),y=n(184),f=n(172),h=n(2),b=n(181),v=n(189),k=n(190),E=n(191),w=n(11),x=n(200),S=n(193),C=n(177);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=Object(h.C)({fontSize:80,margin:"0 80px"}),P=function(e){var t=e.sections,n=e.updateCardValues,o=Object(a.useState)({}),s=Object(l.a)(o,2),d=s[0],p=s[1];return Object(a.useEffect)((function(){p(t.reduce((function(e,t){return z({},e,Object(i.a)({},t.key,t.cards.find((function(e){return e.default})).key))}),{}));var e=!0,a=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(e=(o=s.next()).done);e=!0){var l=o.value,c=l.cards.find((function(e){return e.default}));c&&n(l.key,c.key)}}catch(u){a=!0,r=u}finally{try{e||null==s.return||s.return()}finally{if(a)throw r}}}),[t]),console.log("presets render: selected=(".concat(JSON.stringify(d),")")),[].concat.apply([],t.map((function(e){return[r.a.createElement(g.a,{key:"sep".concat(e.key),styles:{root:{marginTop:"15px !important",marginBottom:"15px"}}},r.a.createElement("b",null,e.sectionTitle)),r.a.createElement(c.a,{key:"stack".concat(e.key),horizontal:!0,tokens:{childrenGap:30}},e.cards.map((function(t,a){return r.a.createElement(b.a,{key:t.key,onClick:function(){return a=e.key,r=t.key,p(z({},d,Object(i.a)({},a,r))),void n(a,r);var a,r},tokens:{childrenMargin:12}},r.a.createElement(v.a,{styles:{root:{padding:"8px 16px",position:"relative"}}},r.a.createElement(k.a,{checked:d[e.key]===t.key,label:t.title,styles:{label:{fontWeight:d[e.key]===t.key?"500":"normal"}}})),t.imageSrc&&r.a.createElement(E.a,{imageSrc:t.imageSrc,height:150,imageFit:w.b.centerContain}),t.icon&&r.a.createElement(x.a,{styles:{root:{backgroundColor:"white",borderBottom:"0"}},previewImages:[{previewIconProps:{iconName:t.icon,className:I},height:100}]}),r.a.createElement("div",{style:{padding:"8px 16px"}},r.a.createElement(u.a,null,t.description.title,t.description.titleWarning&&r.a.createElement(S.a,{messageBarType:t.description.titleWarning.MessageBarType},r.a.createElement(u.a,null,t.description.titleWarning.description)),r.a.createElement(u.a,{variant:"smallPlus"},r.a.createElement("ul",null,t.description.bulets.map((function(e,t){return r.a.createElement("li",{key:t},e.description,e.linksrc&&r.a.createElement("span",null," (",r.a.createElement("a",{target:"_nsg",href:e.linksrc},"docs"),")"))})))))),t.author&&r.a.createElement(C.a,{activity:t.author.status,people:[{name:t.author.name,initials:t.author.initials}]}))})))]})))},N=n(31),O=n(180),D=n(7),T=n(176),M=n(182),B=n(13),G=n(186),K=n(53),_=n(183),j=n(67);function R(e,t){return e.findIndex((function(e){return e.field===t}))>=0}function V(e,t){var n=e.findIndex((function(e){return e.field===t}));return n>=0?e[n].message:""}var F={root:{border:"1px solid",background:"#fcfcfc",margin:"10px 0",padding:"15px"}},L={tokens:{childrenGap:15},styles:{root:{width:300}}},W=function(e){var t=e.tabValues,n=e.updateFn,o=e.invalidArray,s=e.featureFlag,i=t.net,d=t.addons,p=Object(a.useState)(!1),m=Object(l.a)(p,2),y=m[0],f=m[1],h=r.a.createRef();return r.a.createElement(c.a,{tokens:{childrenGap:15},styles:F},r.a.createElement(c.a.Item,null,r.a.createElement(N.a,{required:!0},"Network Plugin"),r.a.createElement(S.a,null,'Typically, only use "kubenet" networking if you need to limit your non-routable IP usage on your network (use network calculator)'),r.a.createElement(O.a,{styles:{root:{marginLeft:"50px"}},selectedKey:i.networkPlugin,options:[{key:"kubenet",text:'Use "kubenet" basic networkin, so your PODs DO NOT receive VNET IPs'},{key:"azure",text:'Use "CNI" for fastest container networking, but using more IPs'}],onChange:function(e,t){var a=t.key;return n("networkPlugin",a)}})),r.a.createElement(g.a,{className:"notopmargin"}),r.a.createElement(c.a.Item,null,r.a.createElement(N.a,null,"Deploy Azure firewall for your cluster egress (Custom VNet Only)"),R(o,"afw")&&r.a.createElement(S.a,{messageBarType:D.a.error},V(o,"afw")),r.a.createElement(k.a,{styles:{root:{marginLeft:"50px",marginTop:"10 !important"}},disabled:!1,errorMessage:V(o,"afw"),checked:i.afw,onChange:function(e,t){return n("afw",t)},label:"Implement Azure Firewall & UDR nexthop"})),r.a.createElement(g.a,{className:"notopmargin"}),r.a.createElement(c.a.Item,null,r.a.createElement(N.a,null,"Secure Azure service resources to your virtual network by extending VNet identity to the service"),r.a.createElement(k.a,{styles:{root:{marginLeft:"50px"}},disabled:!1,checked:i.serviceEndpointsEnable,onChange:function(e,t){return n("serviceEndpointsEnable",t)},label:"Enable Service Endpoints"}),i.serviceEndpointsEnable&&r.a.createElement(c.a,{styles:{root:{marginLeft:"50px",marginTop:"10px"}},tokens:{childrenGap:10}},r.a.createElement(S.a,{messageBarType:D.a.info},"No Network Address Translation (NAT) or gateway devices required to access your Azure dependencies from your pods"),r.a.createElement(T.a,{required:!0,placeholder:"Select options",label:"Select the Azure Dependencies you would like to secure to your AKS VNET",selectedKeys:i.serviceEndpoints,onChange:function(e,t){var a=t.key,r=t.selected;n("serviceEndpoints",r?function(e,t){return e.includes(t)?e:e.concat(t)}(i.serviceEndpoints,a):function(e,t){var n=e.indexOf(t);return n>=0?[].concat(Object(j.a)(e.slice(0,n)),Object(j.a)(e.slice(n+1))):e}(i.serviceEndpoints,a))},multiSelect:!0,options:[{key:"Microsoft.AzureActiveDirectory",text:"Microsoft.AzureActiveDirectory"},{key:"Microsoft.AzureCosmosDB",text:"Microsoft.AzureCosmosDB"},{key:"Microsoft.CognativeServices",text:"Microsoft.CognativeServices"},{key:"Microsoft.ContainerRegistry",text:"Microsoft.ContainerRegistry"},{key:"Microsoft.EventHub",text:"Microsoft.EventHub"},{key:"Microsoft.KeyVault",text:"Microsoft.KeyVault"},{key:"Microsoft.ServiceBus",text:"Microsoft.ServiceBus"},{key:"Microsoft.Sql",text:"Microsoft.Sql"},{key:"Microsoft.Storage",text:"Microsoft.Storage"},{key:"Microsoft.Web",text:"Microsoft.Web"}]}))),r.a.createElement(g.a,{className:"notopmargin"}),r.a.createElement(c.a.Item,null,r.a.createElement(N.a,null,"Uses a private IP address from your VNet to access your dependent Azure service, such as Azure Storage, Azure Cosmos DB, SQL"),r.a.createElement(k.a,{styles:{root:{marginLeft:"50px",marginTop:"0 !important"}},disabled:!1,checked:i.vnetprivateend,onChange:function(e,t){return n("vnetprivateend",t)},label:"Enable Private Link"})),r.a.createElement(g.a,{className:"notopmargin"}),r.a.createElement(c.a.Item,null,r.a.createElement(c.a,{horizontal:!0},r.a.createElement(c.a.Item,null,r.a.createElement(N.a,null,"Default or Custom VNET"),r.a.createElement("div",{ref:h,style:{marginTop:0}},r.a.createElement(O.a,{styles:{root:{marginLeft:"50px"}},selectedKey:i.vnet_opt,onClick:function(){return f(!0)},onChange:function(e,t){var a=t.key;return n("vnet_opt",a)},options:[{key:"default",iconProps:{iconName:"CubeShape"},text:"Default Networking"},{key:"custom",iconProps:{iconName:"CityNext"},text:"Custom Networking"},{key:"byo",disabled:!s,iconProps:{iconName:"WebAppBuilderFragment"},text:"BYO VNET (TBC)"}]}),R(o,"vnet_opt")&&r.a.createElement(S.a,{messageBarType:D.a.error},V(o,"vnet_opt")))),r.a.createElement(c.a.Item,null,y&&"default"===i.vnet_opt&&r.a.createElement(M.a,{className:"ms-CalloutExample-callout",target:h,directionalHint:B.a.leftCenter,isBeakVisible:!0,gapSpace:10,setInitialFocus:!0,onDismiss:function(){return f(!1)}},r.a.createElement(S.a,{messageBarType:D.a.info},"Default - Fully Managed Networking"),r.a.createElement("div",{style:{padding:"10px",maxWidth:"450px"}},r.a.createElement(u.a,null,"Select this option if you ",r.a.createElement(u.a,{style:{fontWeight:"bold"}}," don't")," require any custom IP settings, so you are not peering with other VNETs or On-Premises networks This is the simplest AKS deployment to operate, it provides a ",r.a.createElement(u.a,{style:{fontWeight:"bold"}}," managed")," network setup, including:"),r.a.createElement("ul",null,r.a.createElement("li",null,"New Dedicated VNET with private IP range for your agents nodes"),r.a.createElement("li",null,"Container Networking (default: CNI)"),r.a.createElement("li",null,"Standard LoadBalancer for kubernetes services with outbound rule for internet access")))),y&&"custom"===i.vnet_opt&&r.a.createElement(M.a,{className:"ms-CalloutExample-callout",target:h,directionalHint:B.a.leftCenter,isBeakVisible:!0,gapSpace:10,setInitialFocus:!0,onDismiss:function(){return f(!1)}},r.a.createElement(S.a,{messageBarType:D.a.warning},"Custom Networking - Advanced Setup"),r.a.createElement("div",{style:{padding:"10px",maxWidth:"500px"}},r.a.createElement(u.a,null,"Select this option if you will you would like the helper to create a new VNET with specific ranges, use this option if you need to:",r.a.createElement("ul",null,r.a.createElement("li",null,"Connect your AKS network with another networks"),r.a.createElement("li",null,"You will be VNET peering or using an Expressroute or VPN Gateway"))))),y&&"byo"===i.vnet_opt&&r.a.createElement(M.a,{className:"ms-CalloutExample-callout",target:h,directionalHint:B.a.leftCenter,isBeakVisible:!0,gapSpace:10,setInitialFocus:!0,onDismiss:function(){return f(!1)}},r.a.createElement(S.a,{messageBarType:D.a.warning},"Bring your own Networking - Advanced Setup"),r.a.createElement("div",{style:{padding:"10px",maxWidth:"500px"}},r.a.createElement(u.a,null,"Select this option if you will be deploying AKS into an existing network configuration, for example."),r.a.createElement("ul",null,r.a.createElement("li",null,"If you are implementing the Secure Baseline Architecture ",r.a.createElement(G.a,{target:"_",href:"https://docs.microsoft.com/azure/architecture/reference-architectures/containers/aks/secure-baseline-aks"},"here"),r.a.createElement(K.a,{imageFit:w.b.CenterContain,width:"100%",src:"./secure-baseline-architecture.svg"})),r.a.createElement("li",null,"If you will deploy AKS into a pre-existing VNET, managed by a networking team"))))))),"custom"===i.vnet_opt?r.a.createElement(Z,{addons:d,net:i,updateFn:n}):"byo"===i.vnet_opt&&r.a.createElement(q,{addons:d,net:i,updateFn:n,invalidArray:o}))};function U(e){var t=e.net,n=e.updateFn;return r.a.createElement(c.a,L,r.a.createElement(N.a,null,"Kubernetes Networking Configuration"),r.a.createElement(c.a.Item,{align:"start"},r.a.createElement(_.a,{prefix:"Cidr",label:"POD Network",disabled:"kubenet"!==t.networkPlugin,onChange:function(e,t){return n("podCidr",t)},value:"kubenet"===t.networkPlugin?t.podCidr:"IPs from subnet"})),r.a.createElement(c.a.Item,{align:"start"},r.a.createElement(_.a,{prefix:"Cidr",label:"Service Network",onChange:function(e,t){return n("service",t)},value:t.service}),r.a.createElement(S.a,{messageBarType:D.a.warning},"Address space that isn't in use elsewhere in your network environment ",r.a.createElement("a",{target:"_targ",href:"https://docs.microsoft.com/en-us/azure/aks/configure-kubenet#create-an-aks-cluster-in-the-virtual-network"},"docs"))))}function q(e){var t=e.net,n=e.addons,a=e.updateFn,o=e.invalidArray;return r.a.createElement(c.a,{styles:F},r.a.createElement(N.a,null,"Kubernetes Network Configration"),r.a.createElement(c.a,{horizontal:!0,tokens:{childrenGap:50},styles:{root:{width:650}}},r.a.createElement(c.a,L),r.a.createElement(U,{net:t,updateFn:a})),r.a.createElement(N.a,null,"Bring your Own VNET and Subnets"),r.a.createElement(S.a,null,"Get your user subnet by running ",r.a.createElement(N.a,null,"az network vnet subnet show --vnet-name `","<net name>","` -g `","<vnet rg>","` -n `","<subnet name>",'` --query "id"')),r.a.createElement(_.a,{value:t.byoAKSSubnetId,onChange:function(e,t){return a("byoAKSSubnetId",t)},errorMessage:V(o,"byoAKSSubnetId"),required:!0,placeholder:"Resource Id",label:r.a.createElement(u.a,{style:{fontWeight:600}},"Enter your existing AKS Nodes subnet ResourceId")}),r.a.createElement(g.a,{className:"notopmargin"}),r.a.createElement(_.a,{disabled:"appgw"!==n.ingress,value:t.byoAGWSubnetId,onChange:function(e,t){return a("byoAGWSubnetId",t)},errorMessage:V(o,"byoAGWSubnetId"),required:!0,placeholder:"Resource Id",label:r.a.createElement(u.a,{style:{fontWeight:600}},"Enter your existing Application Gateway subnet ResourceId")}),r.a.createElement(S.a,{messageBarType:D.a.warning},"Ensure your Application Gateway subnet meets these requirements ",r.a.createElement(G.a,{href:"https://docs.microsoft.com/en-us/azure/application-gateway/configuration-infrastructure#size-of-the-subnet"},"here")))}function Z(e){var t=e.net,n=e.addons,a=e.updateFn;return r.a.createElement(c.a,{styles:F},r.a.createElement(N.a,null,"Custom Network VENT & Kubernetes Network Configration"),r.a.createElement(c.a,{horizontal:!0,tokens:{childrenGap:50},styles:{root:{width:650}}},r.a.createElement(c.a,L,r.a.createElement(c.a.Item,{align:"start"},r.a.createElement(_.a,{prefix:"Cidr",label:"VNET Address space",onChange:function(e,t){return a("vnet",t)},value:t.vnet})),r.a.createElement(c.a.Item,{align:"center"},r.a.createElement(_.a,{prefix:"Cidr",label:"AKS Nodes subnet",onChange:function(e,t){return a("akssub",t)},value:t.akssub})),r.a.createElement(c.a.Item,{align:"center"},r.a.createElement(_.a,{prefix:"Cidr",disabled:!t.afw,label:"Azure Firewall subnet",onChange:function(e,t){return a("afwsub",t)},value:t.afw?t.afwsub:"No Firewall requested"})),r.a.createElement(c.a.Item,{align:"center"},r.a.createElement(_.a,{prefix:"Cidr",disabled:"appgw"!==n.ingress,label:"Application Gateway subnet",onChange:function(e,t){return a("agsub",t)},value:"appgw"===n.ingress?t.agsub:"N/A"}))),r.a.createElement(U,{net:t,updateFn:a})))}var H=function(e){var t=e.tabValues,n=e.updateFn,a=e.invalidArray,o=t.addons,s=t.net,i=t.deploy;return r.a.createElement(c.a,{tokens:{childrenGap:15},styles:F},r.a.createElement(c.a.Item,{align:"start"},r.a.createElement(N.a,null,"Cluster Monitoring requirements"),r.a.createElement(S.a,null,"Observing your clusters health is critical to smooth operations, select the managed Azure Monior for Containers option, or the opensource CNCF Promethous/Grafana solution"),r.a.createElement(O.a,{styles:{root:{marginLeft:"50px"}},selectedKey:o.monitor,options:[{key:"none",text:"None"},{key:"aci",text:"Azure Monitor for Containers (logs and metrics)"},{key:"oss",text:"Promethous / Grafana Helm Chart (metrics only)"}],onChange:function(e,t){var a=t.key;return n("monitor",a)}})),r.a.createElement(c.a.Item,{align:"center",styles:{root:{width:"600px",display:"aci"!==o.monitor?"none":"block"}}},r.a.createElement(T.a,{label:"Log and Metrics Data Retention (Days)",onChange:function(e,t){var a=t.key;return n("retentionInDays",a)},selectedKey:o.retentionInDays,options:[{key:30,text:"30 Days"},{key:60,text:"60 Days"},{key:90,text:"90 Days"},{key:120,text:"120 Days"},{key:180,text:"180 Days"},{key:270,text:"270 Days"},{key:365,text:"365 Days"}]})),r.a.createElement(g.a,{className:"notopmargin"}),r.a.createElement(c.a.Item,{align:"start"},r.a.createElement(N.a,null,"Azure Policy, to manage and report on the compliance state of your Kubernetes clusters"),r.a.createElement(S.a,null,"Azure Policy extends Gatekeeper v3, an admission controller webhook for Open Policy Agent (OPA), to apply at-scale enforcements and safeguards on your clusters in a centralized, consistent manner."),r.a.createElement(O.a,{styles:{root:{marginLeft:"50px"}},selectedKey:o.azurepolicy,options:[{key:"none",text:"No restrictions, users can deploy any kubernetes workloads"},{key:"audit",text:"AUDIT complience with the set of cluster pod security baseline standards for Linux-based workloads"},{key:"deny",text:"BLOCK and non-complient Linux-based workloads with the set of cluster pod security baseline standards"}],onChange:function(e,t){var a=t.key;return n("azurepolicy",a)}}),"none"!==o.azurepolicy&&r.a.createElement(S.a,{messageBarType:"audit"===o.azurepolicy?D.a.success:D.a.blocked,styles:{root:{marginLeft:"50px",width:"700px"}}},"The template will automatically assign and ",r.a.createElement("b",null,o.azurepolicy)," the following ",r.a.createElement(G.a,{target:"_target",href:"https://github.com/Azure/azure-policy/blob/master/built-in-policies/policySetDefinitions/Kubernetes/Kubernetes_PSPBaselineStandard.json"},"Policies"),":",r.a.createElement("ul",null,r.a.createElement("li",null,"Do not allow privileged containers in Kubernetes cluster"),r.a.createElement("li",null,"Kubernetes cluster pods should only use approved host network and port range"),r.a.createElement("li",null,"Kubernetes cluster containers should not share host process ID or host IPC namespace"),r.a.createElement("li",null,"Kubernetes cluster containers should only use allowed capabilities"),r.a.createElement("li",null,"Kubernetes cluster pod hostPath volumes should only use allowed host paths")))),r.a.createElement(g.a,{className:"notopmargin"}),r.a.createElement(c.a.Item,{align:"start"},r.a.createElement(N.a,null,"Cluster East-West traffic restrictions (Network Policies)"),r.a.createElement(S.a,null,"Control which components can communicate with each other. The principle of least privilege should be applied to how traffic can flow between pods in an Azure Kubernetes Service (AKS) cluster"),r.a.createElement(O.a,{styles:{root:{marginLeft:"50px"}},selectedKey:o.networkPolicy,options:[{key:"none",text:"No restrictions, all PODs can access each other"},{key:"calico",text:'Use Network Pollicy addon with Calico to implemented intra-cluster traffic restrictions (driven from "NetworkPolicy" objects)'},{key:"azure",text:'Use Network Pollicy addon with Azure provider to implemented intra-cluster traffic restrictions (driven from "NetworkPolicy" objects)'}],onChange:function(e,t){var a=t.key;return n("networkPolicy",a)}})),r.a.createElement(g.a,{className:"notopmargin"}),r.a.createElement(c.a.Item,{align:"start"},r.a.createElement(N.a,{required:!0},"Securely Expose your applications via Layer 7 HTTP(S) proxies (Ingress Controller)"),r.a.createElement(O.a,{styles:{root:{marginLeft:"50px"}},selectedKey:o.ingress,options:[{key:"none",text:"No, I dont need a Layer7 proxy, or I will configure my own solution"},{key:"nginx",text:"Yes, deploy nginx in the cluster to expose my apps to the internet (nginx ingress controller)"},{key:"appgw",text:"Yes, I want a Azure Managed Application Gateway with WAF protection"}],onChange:function(e,t){var a=t.key;return n("ingress",a)}})),r.a.createElement(c.a.Item,{align:"center",styles:{root:{maxWidth:"700px",display:"none"===o.ingress?"none":"block"}}},r.a.createElement(c.a,{tokens:{childrenGap:15}},"nginx"===o.ingress&&!1,"none"!==o.ingress&&!1,"nginx"===o.ingress&&r.a.createElement(k.a,{checked:o.ingressEveryNode,onChange:function(e,t){return n("ingressEveryNode",t)},label:r.a.createElement(u.a,null,"Run nginx on every node (deploy as Daemonset)")}),("nginx"===o.ingress||"appgw"===o.ingress)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{checked:o.dns,onChange:function(e,t){return n("dns",t)},label:r.a.createElement(u.a,null,"Create FQDN URLs for your applications using external-dns (Beta) (requires ",r.a.createElement(u.a,{style:{fontWeight:"bold"}},"Azure DNS Zone")," - ",r.a.createElement(G.a,{href:"https://docs.microsoft.com/en-us/azure/dns/dns-getstarted-portal#create-a-dns-zone",target:"_t1"},"how to create"),")")}),o.dns&&r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,{value:o.dnsZoneId,onChange:function(e,t){return n("dnsZoneId",t)},errorMessage:V(a,"dnsZoneId"),required:!0,placeholder:"Resource Id",label:r.a.createElement(u.a,{style:{fontWeight:600}},"Enter your Azure DNS Zone ResourceId ",r.a.createElement(G.a,{target:"_t2",href:"https://ms.portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones"},"find it here"))}),r.a.createElement(k.a,{disabled:R(a,"dnsZoneId"),checked:o.certMan,onChange:function(e,t){return n("certMan",t)},label:"Automatically Issue Certificates for HTTPS using cert-manager (with Lets Encrypt - requires email"}),o.certMan&&r.a.createElement(_.a,{value:o.certEmail,onChange:function(e,t){return n("certEmail",t)},errorMessage:V(a,"certEmail")?"Enter valid email":"",label:"Enter mail address for certificate notification:",required:!0}))))),r.a.createElement(g.a,{className:"notopmargin"}),r.a.createElement(c.a.Item,{align:"start"},r.a.createElement(N.a,{required:!0},"Do you require a secure private container registry to store my application images"),r.a.createElement(O.a,{styles:{root:{marginLeft:"50px"}},selectedKey:o.registry,options:[{key:"none",text:"No, my application images will be on dockerhub or another registry"},{key:"Basic",text:'Yes, setup Azure Container Registry "Basic" tier & authorise aks to pull images'},{key:"Standard",text:'Yes, setup Azure Container Registry "Standard" tier (recommended for production)'},{key:"Premium",text:'Yes, setup Azure Container Registry "Premium" tier (required for Service Endpoints & Private Link)'}],onChange:function(e,t){var a=t.key;return n("registry",a)}}),R(a,"registry")&&r.a.createElement(S.a,{styles:{root:{marginLeft:"50px",width:"700px"}},messageBarType:D.a.error},V(a,"registry")),s.serviceEndpointsEnable&&s.serviceEndpoints.includes("Microsoft.ContainerRegistry")&&"Premium"===o.registry&&r.a.createElement(S.a,{styles:{root:{marginLeft:"50px",width:"700px"}},messageBarType:D.a.warning},"As you have selected Container Registry in Networking Service Endpoint, the templte will only Allow traffic to your Registry from the AKS Subnet, and your specified IP addresses ",r.a.createElement("b",null,i.apiips.split(","))," (",r.a.createElement(G.a,{href:"https://docs.microsoft.com/en-us/azure/container-registry/container-registry-vnet"},"docs"),") *** Preview feature")),r.a.createElement(g.a,{className:"notopmargin"}),r.a.createElement(c.a.Item,{align:"start"},r.a.createElement(N.a,{required:!0},"Store Kubernetes Secrets in Azure Keyvault, using AKS Managed Identity (**Preview) (",r.a.createElement("a",{target:"_new",href:"https://docs.microsoft.com/en-us/azure/aks/csi-secrets-store-driver"},"docs"),")"),r.a.createElement(O.a,{styles:{root:{marginLeft:"50px"}},selectedKey:o.csisecret,options:[{key:"none",text:"No, I am happy to use the default kuberentes secret storage, or I will configure my own solution"},{key:"akvExist",text:"Yes, store secrets in an existing KeyVault & enable Secrets Store CSI Driver"},{key:"akvNew",text:"Yes, provision a new Azure KeyVault & enable Secrets Store CSI Driver"}],onChange:function(e,t){var a=t.key;return n("csisecret",a)}})),r.a.createElement(c.a.Item,{align:"center",styles:{root:{minWidth:"700px",display:"none"===o.csisecret?"none":"block"}}},r.a.createElement(S.a,{messageBarType:D.a.warning},"Ensure you register for this preview feature ",r.a.createElement(G.a,{href:"https://docs.microsoft.com/en-us/azure/aks/csi-secrets-store-driver#register-the-aks-azurekeyvaultsecretsprovider-preview-feature"},"here")),r.a.createElement(c.a,{tokens:{childrenGap:15}},"akvExist"===o.csisecret&&r.a.createElement(_.a,{value:o.kvId,onChange:function(e,t){return n("kvId",t)},errorMessage:V(a,"kvId"),required:!0,placeholder:"Resource Id",label:r.a.createElement(u.a,{style:{fontWeight:600}},"Enter your Azure Key Vault Resource Id")}))))},Y=n(171),J=n(187),$=Object(h.C)({display:"flex",alignItems:"baseline"}),Q=[{key:"b",text:"Burstable (dev/test)",itemType:Y.a.Header},{key:"Standard_B2s",text:"2 vCPU,  4 GiB RAM,   8GiB SSD, 40%\t-> 200% CPU",eph:!0},{key:"dv2",text:"General purpose V2",itemType:Y.a.Header},{key:"default",text:"2 vCPU,  7 GiB RAM,  14GiB SSD,  86 GiB cache (8000 IOPS)",eph:!1},{key:"Standard_DS3_v2",text:"4 vCPU, 14 GiB RAM,  28GiB SSD, 172 GiB cache (16000 IOPS)",eph:!0},{key:"dv4",text:"General purpose V4",itemType:Y.a.Header},{key:"Standard_D2ds_v4",text:"2 vCPU,  8 GiB RAM,  75GiB SSD,               (19000 IOPS)",eph:!1},{key:"Standard_D4ds_v4",text:"4 vCPU, 16 GiB RAM, 150GiB SSD, 100 GiB cache (38500 IOPS)",eph:!1},{key:"Standard_D8ds_v4",text:"8 vCPU, 32 GiB RAM, 300GiB SSD,               (77000 IOPS)",eph:!0},{key:"fv2",text:"Compute optimized",itemType:Y.a.Header},{key:"Standard_F2s_v2",text:"2 vCPU,  4 GiB RAM,  16GiB SSD,               (3200 IOPS)",eph:!1}],X=function(e){var t=e.tabValues,n=e.updateFn,a=e.invalidArray,o=t.cluster;return r.a.createElement(c.a,{tokens:{childrenGap:15},styles:F},r.a.createElement(N.a,{style:{marginBottom:"10px"}},"Cluster Performance & Scale Requirements (system nodepool)"),r.a.createElement(c.a,{vertical:!0,tokens:{childrenGap:15},style:{marginTop:0,marginLeft:"50px"}},r.a.createElement(c.a,{horizontal:!0,tokens:{childrenGap:150}},r.a.createElement(c.a.Item,null,r.a.createElement(O.a,{selectedKey:o.autoscale,onChange:function(e,t){var a=t.key;return n("autoscale",a)},options:[{key:!1,iconProps:{iconName:"FollowUser"},text:"Manual scale"},{key:!0,iconProps:{iconName:"ScaleVolume"},text:"Autoscale"}]})),r.a.createElement(c.a.Item,null,r.a.createElement(c.a,{tokens:{childrenGap:0},styles:{root:{width:450}}},r.a.createElement(J.a,{label:"Initial ".concat(o.autoscale?"(& Autoscaler Min nodes)":"nodes"),min:1,max:10,step:1,defaultValue:o.count,showValue:!0,onChange:function(e){return n("count",e)}}),o.autoscale&&r.a.createElement(J.a,{label:"Autoscaler Max nodes",min:5,max:100,step:5,defaultValue:o.maxCount,showValue:!0,onChange:function(e){return n("maxCount",e)},snapToStep:!0})))),r.a.createElement(c.a,{horizontal:!0,tokens:{childrenGap:55}},r.a.createElement(c.a.Item,null,r.a.createElement(N.a,null,"Compute Type"),r.a.createElement(O.a,{selectedKey:"gp",options:[{key:"gp",iconProps:{iconName:"Processing"},text:"General Purpose"},{key:"iops",iconProps:{iconName:"OfflineStorageSolid"},text:"IO Optimised",disabled:!0},{key:"gpu",iconProps:{iconName:"Game"},text:"GPU Workloads",disabled:!0}]})),r.a.createElement(c.a.Item,null,r.a.createElement(N.a,null,"Node Size"),r.a.createElement(c.a,{tokens:{childrenGap:10},styles:{root:{width:450}}},r.a.createElement(T.a,{selectedKey:o.vmSize,onChange:function(e,t){var a=t.key;return n("vmSize",a)},placeholder:"Select VM Size",options:Q,styles:{dropdown:{width:"100%"}}}),R(a,"osDiskType")&&r.a.createElement(S.a,{messageBarType:D.a.error},V(a,"osDiskType")),r.a.createElement(O.a,{onChange:function(e,t){var a=t.key;return n("osDiskType",a)},selectedKey:o.osDiskType,options:[{key:"Ephemperal",text:"Ephemperal (Requires Node with >137GiB of cache)"},{key:"Managed",text:"Persistant in Storage Account"}]}),"Managed"===o.osDiskType&&r.a.createElement(T.a,{label:"OS disk size",selectedKey:o.osDiskSizeGB,onChange:function(e,t){var a=t.key;return n("osDiskSizeGB",a)},placeholder:"Select OS Disk",options:[{key:"df",text:"Use the default for the VM size",itemType:Y.a.Header},{key:0,text:"default"},{key:"pd",text:"Premium SSD Managed Disks",itemType:Y.a.Header},{key:32,text:"32 GiB (120 IOPS)"},{key:64,text:"64 GiB (240 IOPS)"},{key:128,text:"128 GiB (500 IOPS)"}],styles:{dropdown:{width:"100%"}}}))))),r.a.createElement(g.a,{className:"notopmargin"}),r.a.createElement(c.a.Item,{align:"start"},r.a.createElement(N.a,{required:!0},"Zone Support - Do you want to deploy your nodes across Availability Zones"),r.a.createElement(O.a,{selectedKey:o.availabilityZones,styles:{root:{marginLeft:"50px"}},options:[{key:"no",text:"Deploy into single zone"},{key:"yes",text:"Deploy my control plane and nodes across all availiability zones (**storage)"}],onChange:function(e,t){var a=t.key;return n("availabilityZones",a)}})),r.a.createElement(g.a,{className:"notopmargin"}),r.a.createElement(c.a.Item,{align:"start"},r.a.createElement(N.a,{required:!0},"Cluster Auto-upgrade"),r.a.createElement(O.a,{selectedKey:o.upgradeChannel,styles:{root:{marginLeft:"50px"}},options:[{key:"none",text:"Disables auto-upgrades"},{key:"patch",text:"Patch: auto-upgrade cluster to the latest supported patch version when it becomes available while keeping the minor version the same."},{key:"stable",text:"Stable: auto-upgrade cluster to the latest supported patch release on minor version N-1, where N is the latest supported minor version"},{key:"rapid",text:"Rapid: auto-upgrade cluster to the latest supported patch release on the latest supported minor version."}],onChange:function(e,t){var a=t.key;return n("upgradeChannel",a)}})),r.a.createElement(g.a,{className:"notopmargin"}),r.a.createElement(c.a,{horizontal:!0,tokens:{childrenGap:142},styles:{root:{marginTop:10}}},r.a.createElement(c.a.Item,null,r.a.createElement(O.a,{styles:{root:{marginLeft:"50px"}},label:r.a.createElement(N.a,null,"Cluster User Authentication ",r.a.createElement(G.a,{target:"_",href:"https://docs.microsoft.com/en-gb/azure/aks/managed-aad"},"docs")),selectedKey:o.enable_aad,onChange:function(e,t){var a=t.key;return n("enable_aad",a)},options:[{key:!1,iconProps:{iconName:"UserWarning"},text:"Kubernetes"},{key:!0,iconProps:{iconName:"AADLogo"},text:"AAD Integrated"}]})),r.a.createElement(c.a.Item,null,o.enable_aad&&r.a.createElement(c.a,{tokens:{childrenGap:10},styles:{root:{width:450,marginTop:"30px"}}},r.a.createElement(O.a,{styles:{root:{width:300}},selectedKey:o.use_alt_aad,options:[{key:!1,text:"Use the AKS subscription tenant"},{key:!0,text:"Use alt. tenant",onRenderField:function(e,t){return r.a.createElement("div",{className:$},t(e),r.a.createElement(_.a,{value:o.aad_tenant_id,onChange:function(e,t){return n("aad_tenant_id",t)},errorMessage:V(a,"aad_tenant_id"),styles:{root:{marginLeft:5}},disabled:!!e&&!o.use_alt_aad,required:!0,placeholder:"tenant id"}))}}],onChange:function(e,t){var a=t.key;return n("use_alt_aad",a)}}),r.a.createElement(k.a,{checked:o.enableAzureRBAC,onChange:function(e,t){return n("enableAzureRBAC",t)},onRenderLabel:function(){return r.a.createElement(u.a,{styles:{root:{color:"black"}}},"Azure RBAC for Kubernetes Authorization ",r.a.createElement(G.a,{target:"_",href:"https://docs.microsoft.com/en-us/azure/aks/manage-azure-rbac"},"docs"),"**")}}),o.enableAzureRBAC?r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,null,"Assign Cluster Admin Role to user (optional)"),r.a.createElement(S.a,{styles:{root:{marginBottom:"10px"}}},"Get your user principleId by running ",r.a.createElement(N.a,null,"az ad user show --id `","<work-email>","` --query objectId --out tsv")),r.a.createElement(_.a,{prefix:"AAD PrincipleId",onChange:function(e,t){return n("adminprincipleid",t)},value:o.adminprincipleid})):r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,{label:"AAD Group objectIDs that will have admin role of the cluster ',' seperated",onChange:function(e,t){return n("aadgroupids",t)},value:o.aadgroupids}),o.enable_aad&&!o.aadgroupids&&r.a.createElement(S.a,{messageBarType:D.a.warning},"You will be forbidden to do any kubernetes options unless you add a AAD Groups here, or follow ",r.a.createElement(G.a,{target:"_",href:"https://docs.microsoft.com/en-us/azure/aks/azure-ad-rbac#create-the-aks-cluster-resources-for-app-devs"},"this")," after the cluster is created"))))),r.a.createElement(g.a,{className:"notopmargin"}),r.a.createElement(c.a.Item,{align:"start"},r.a.createElement(N.a,{required:!0},"Cluster API Server Secuity"),r.a.createElement(O.a,{selectedKey:o.apisecurity,styles:{root:{marginLeft:"50px"}},options:[{key:"none",text:"Public IP with no IP restrictions"},{key:"whitelist",text:"Create allowed IP ranges (defaults to IP address of machine running the script)"},{key:"private",text:"Private Cluster (WARNING: requires jummpbox to access)"}],onChange:function(e,t){var a=t.key;return n("apisecurity",a)}})))};function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne=function(e){var t,n=e.updateFn,a=e.tabValues,o=e.invalidArray,s=e.invalidTabs,l=a.net,p=a.addons,m=a.cluster,h=a.deploy,b=!(s&&s.length>0),v=h.apiips.split(",").filter((function(e){return e.trim()})),k=te({resourceName:h.clusterName,kubernetesVersion:h.kubernetesVersion,agentCount:m.count},"default"!==m.vmSize&&{agentVMSize:m.vmSize},{},m.autoscale&&{agentCountMax:m.maxCount},{},"Managed"===m.osDiskType&&te({osDiskType:m.osDiskType},m.osDiskSizeGB>0&&{osDiskSizeGB:m.osDiskSizeGB}),{},"custom"===l.vnet_opt&&{custom_vnet:"true"},{},"byo"===l.vnet_opt&&{byoAKSSubnetId:l.byoAKSSubnetId},{},"byo"===l.vnet_opt&&"appgw"===p.ingress&&{byoAGWSubnetId:l.byoAGWSubnetId},{},m.enable_aad&&te({enable_aad:"true"},!1===m.enableAzureRBAC&&m.aad_tenant_id&&{aad_tenant_id:m.aad_tenant_id}),{},m.enable_aad&&m.enableAzureRBAC&&te({enableAzureRBAC:"true"},m.adminprincipleid&&{adminprincipleid:m.adminprincipleid}),{},"none"!==p.registry&&{registries_sku:p.registry},{},l.afw&&{azureFirewalls:"true"},{},l.serviceEndpointsEnable&&l.serviceEndpoints.size>0&&{serviceEndpoints:JSON.stringify(Array.from(l.serviceEndpoints).map((function(e){return{service:e}}))).replaceAll('"','\\"')},{},"aci"===p.monitor&&{omsagent:"true",retentionInDays:p.retentionInDays},{},"none"!==p.networkPolicy&&{networkPolicy:p.networkPolicy},{},"none"!==p.azurepolicy&&{azurepolicy:p.azurepolicy},{},"azure"!==l.networkPlugin&&{networkPlugin:l.networkPlugin},{},"yes"===m.availabilityZones&&{availabilityZones:JSON.stringify(["1","2","3"]).replaceAll(" ","").replaceAll('"','\\"')},{},"whitelist"===m.apisecurity&&v.length>0&&{authorizedIPRanges:JSON.stringify(v).replaceAll(" ","").replaceAll('"','\\"')},{},"private"===m.apisecurity&&{enablePrivateCluster:"true"},{},p.dns&&p.dnsZoneId&&{dnsZoneId:p.dnsZoneId},{},"appgw"===p.ingress&&{ingressApplicationGateway:"true"},{},"none"!==m.upgradeChannel&&{upgradeChannel:m.upgradeChannel},{},l.serviceEndpointsEnable&&l.serviceEndpoints.includes("Microsoft.KeyVault")&&"akvNew"===p.csisecret&&{AKVserviceEndpointFW:v.length>0?v[0]:"vnetonly"}),E=te({},l.serviceEndpointsEnable&&l.serviceEndpoints.includes("Microsoft.ContainerRegistry")&&"Premium"===p.registry&&{ACRserviceEndpointFW:v.length>0?v[0]:"vnetonly"},{},"none"!==p.gitops&&{gitops:p.gitops},{},"none"!==p.csisecret&&te({azureKeyvaultSecretsProvider:!0},"akvNew"===p.csisecret&&{createKV:"true"})),w=te({},k,{},!h.disablePreviews&&E),x="# Create Resource Group \n"+"az group create -l ".concat(h.location," -n ").concat(h.clusterName,"-rg \n\n")+"# Deploy template with in-line paramters \n"+"az deployment group create -g ".concat(h.clusterName,"-rg  ").concat("--template-uri https://raw.githubusercontent.com/khowling/aks-deploy-arm/master/build/main.json"," --parameters")+(t=w,Object.keys(t).map((function(e){return" \\\n\t".concat(e,"=").concat(t[e])})).join("")),C=JSON.stringify(function(e){return Object.keys(e).reduce((function(t,n){return te({},t,{parameters:te({},t.parameters,Object(i.a)({},n,{value:e[n]}))})}),{$schema:"https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",contentVersion:"1.0.0.0",parameters:{}})}(w),null,2),A=("custom"===l.vnet_opt&&"appgw"===p.ingress?"# Workaround to enabling the appgw addon with custom vnet (until supported by template)\naz aks enable-addons -n ".concat(h.clusterName," -g ").concat(h.clusterName,"-rg -a ingress-appgw --appgw-id $(az network application-gateway show -g ").concat(h.clusterName,"-rg -n ").concat(h.clusterName,"-appgw --query id -o tsv)\n"):"")+("none"!==p.csisecret?"# Workaround to enabling the csisecret addon (in preview)\naz aks enable-addons -n ".concat(h.clusterName," -g ").concat(h.clusterName,"-rg -a azure-keyvault-secrets-provider\n"):"")+"# Get admin credentials for your new AKS cluster\naz aks get-credentials -g ".concat(h.clusterName,"-rg -n ").concat(h.clusterName," --admin ")+("oss"===p.monitor?"\n\n# Install kube-prometheus-stack\nhelm repo add prometheus-community https://prometheus-community.github.io/helm-charts\nhelm repo update\nkubectl create namespace ".concat("monitoring","\nhelm install ").concat("monitoring"," prometheus-community/kube-prometheus-stack --namespace ").concat("monitoring"):"")+("nginx"===p.ingress?"\n\n# Create a namespace for your ingress resources\nkubectl create namespace ".concat("ingress-basic","\n\n# Add the ingress-nginx repository\nhelm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx\n\n# Use Helm to deploy an NGINX ingress controller\nhelm install ").concat("nginx-ingress"," ingress-nginx/ingress-nginx \\\n  --set controller.publishService.enabled=true \\\n")+(p.ingressEveryNode?"  --set controller.kind=DaemonSet \\\n  --set controller.service.externalTrafficPolicy=Local \\\n":"")+("oss"===p.monitor?"  --set controller.metrics.enabled=true \\\n  --set controller.metrics.serviceMonitor.enabled=true \\\n  --set controller.metrics.serviceMonitor.namespace=".concat("monitoring"," \\\n  --set controller.metrics.serviceMonitor.additionalLabels.release=").concat("monitoring"," \\\n"):"")+"  --namespace ".concat("ingress-basic"):"")+(p.dnsZoneId?'\n\n# Install external-dns\nkubectl create secret generic azure-config-file --from-file=azure.json=/dev/stdin<<EOF\n{\n  "userAssignedIdentityID": "$(az aks show -g '.concat(h.clusterName,"-rg -n ").concat(h.clusterName,' --query identityProfile.kubeletidentity.clientId -o tsv)",\n  "tenantId": "$(az account show --query tenantId -o tsv)",\n  "useManagedIdentityExtension": true,\n  "subscriptionId": "').concat(p.dnsZoneId.split("/")[2],'",\n  "resourceGroup": "').concat(p.dnsZoneId.split("/")[4],"\"\n}\nEOF\n\ncurl https://raw.githubusercontent.com/khowling/aks-deploy-arm/master/cluster-config/external-dns.yml | sed '/- --provider=azure/a\\            - --domain-filter=").concat(p.dnsZoneId.split("/")[8],"' | kubectl apply -f -"):"")+(p.certEmail?'\n\n# Install cert-manager\nkubectl apply -f https://github.com/jetstack/cert-manager/releases/download/v1.1.0/cert-manager.yaml\n\nsleep 30s\n\ncat <<EOF | kubectl create -f -\napiVersion: cert-manager.io/v1\nkind: ClusterIssuer\nmetadata:\n  name: letsencrypt-prod\nspec:\n  acme:\n    # The ACME server URL\n    server: https://acme-v02.api.letsencrypt.org/directory\n    # Email address used for ACME registration\n    email: "'.concat(p.certEmail,'"\n    # Name of a secret used to store the ACME account private key\n    privateKeySecretRef:\n      name: letsencrypt-prod\n    # Enable the HTTP-01 challenge provider\n    solvers:\n    - http01:\n        ingress:\n          class: ').concat("nginx"===p.ingress?"nginx":"azure/application-gateway","\nEOF\n"):"");return r.a.createElement(c.a,{tokens:{childrenGap:15},styles:F},!b&&r.a.createElement(S.a,{messageBarType:D.a.severeWarning},r.a.createElement(u.a,null,"Configration not complete, please correct the tabs with the warning symbol ",r.a.createElement("b",null,"(",s.join(" & "),")")," before deploying")),r.a.createElement(c.a,{horizontal:!0,styles:{root:{width:"100%"}},tokens:{childrenGap:150}},r.a.createElement(c.a,{styles:{root:{width:"300px"}}},r.a.createElement(_.a,{label:"Cluster Name",onChange:function(e,t){return n("clusterName",t)},required:!0,errorMessage:V(o,"clusterName"),value:h.clusterName}),r.a.createElement(T.a,{label:"Location",selectedKey:h.location,onChange:function(e,t){var a=t.key;return n("location",a)},options:[{key:"europe",text:"Europe",itemType:Y.a.Header},{key:"WestEurope",text:"West Europe"},{key:"NorthEurope",text:"North Europe"},{key:"UKSouth",text:"UK South"},{key:"UKSouth2",text:"UK South2"},{key:"UKWest",text:"UK West"},{key:"america",text:"North America",itemType:Y.a.Header},{key:"CentralUS",text:"Central US"},{key:"EastUS",text:"East US"},{key:"EastUS2",text:"East US2"},{key:"WestUS",text:"West US"},{key:"WestUS2",text:"West US2"},{key:"WestCentralUS",text:"West Central US"}],styles:{dropdown:{width:300}}})),r.a.createElement(c.a,{tokens:{childrenGap:20},styles:{root:{width:"450px"}}},r.a.createElement(_.a,{label:"Kubernetes version",readOnly:!1,disabled:!1,required:!0,value:h.kubernetesVersion,onChange:function(e,t){return n("kubernetesVersion",t)}}),r.a.createElement(c.a.Item,{styles:{root:{display:"whitelist"!==m.apisecurity?"none":"block"}}},r.a.createElement(_.a,{label:"Initial api server whitelisted IPs/CIDRs  (',' seperated)",errorMessage:V(o,"apiips"),onChange:function(e,t){return n("apiips",t)},value:h.apiips,required:"whitelist"===m.apisecurity})))),r.a.createElement(g.a,{styles:{root:{marginTop:"30px !important"}}},r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},r.a.createElement("b",{style:{marginRight:"10px"}},"Deploy Cluster"),r.a.createElement(K.a,{src:"./bicep.png"})," ",r.a.createElement("p",{style:{marginLeft:"10px"}},"powered by Bicep"))," "),Object.keys(E).length>0&&r.a.createElement(S.a,{messageBarType:D.a.warning},r.a.createElement(u.a,null,"Your deployment contains Preview features: ",r.a.createElement("b",null,Object.keys(E).join(",")),", Ensure you have registered for these previews, and have installed the ",r.a.createElement("b",null,"'az extension add --name aks-preview'"),"  before running the script, ",r.a.createElement(G.a,{target:"_pv",href:"https://github.com/Azure/AKS/blob/master/previews.md"},"see here"),", or disable preview features here"),r.a.createElement(d.a,{styles:{root:{marginTop:"10px"}},onText:"preview enabled",offText:"preview disabled",checked:!h.disablePreviews,onChange:function(e,t){return n("disablePreviews",!t)}})),r.a.createElement(y.a,null,r.a.createElement(f.a,{headerText:"Provision Environment (CLI)"},r.a.createElement(_.a,{value:x,rows:x.split(/\r\n|\r|\n/).length+1,readOnly:!0,label:"Commands to deploy your fully operational environment",styles:{root:{fontFamily:'Monaco, Menlo, Consolas, "Droid Sans Mono", Inconsolata, "Courier New", monospace'},field:{backgroundColor:"lightgrey",lineHeight:"21px"}},multiline:!0,errorMessage:b?"":"Please complete all items that need attention before running script"}),r.a.createElement(u.a,{styles:{root:{marginTop:"2px !important"}},variant:"medium"},"Open a Linux shell (requires 'az cli' pre-installed), or, open the",r.a.createElement(G.a,{target:"_cs",href:"http://shell.azure.com/"},"Azure Cloud Shell"),".",r.a.createElement(u.a,{variant:"medium",style:{fontWeight:"bold"}},"Paste the commands")," into the shell")),r.a.createElement(f.a,{headerText:"Provision Environment (CI/CD)"},r.a.createElement(_.a,{value:"TBC",rows:5,readOnly:!0,label:"Github action",styles:{root:{fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace!important"},field:{backgroundColor:"lightgrey",lineHeight:"21px"}},multiline:!0}),r.a.createElement(_.a,{value:C,rows:C.split(/\r\n|\r|\n/).length+1,readOnly:!0,label:"Parameter file",styles:{root:{fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace!important"},field:{backgroundColor:"lightgrey",lineHeight:"21px"}},multiline:!0})),r.a.createElement(f.a,{headerText:"Post Configuration"},"none"===p.gitops?r.a.createElement(c.a,null,r.a.createElement(N.a,null,"Run these commands to install the requeted kubernetes packages into your cluster"),r.a.createElement(S.a,null,"Once available, we will switch to using the gitops addon here, to assure that your clusters get their source of truth from the defined git repo"),r.a.createElement(_.a,{readOnly:!0,label:"Commands (requires helm)",styles:{root:{fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace!important"},field:{backgroundColor:"lightgrey",lineHeight:"21px"}},multiline:!0,rows:A.split(/\r\n|\r|\n/).length+1,value:A})):r.a.createElement(c.a,null,r.a.createElement(_.a,{readOnly:!0,label:"While Gitops is in preview, run this manually",styles:{root:{fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace!important"},field:{backgroundColor:"lightgrey",lineHeight:"21px"}},multiline:!0,rows:6,value:"az k8sconfiguration create\n        --name cluster-config \n        --cluster-name ".concat(h.clusterName,"    \n        --resource-group ").concat(h.clusterName,"-rg     \n        --operator-instance-name flux     \n        --operator-namespace cluster-config     \n        --enable-helm-operator     \n        --operator-params='--git-readonly --git-path=cluster-config'     \n        --repository-url git://github.com/khowling/aks-deploy-arm.git     \n        --scope cluster     \n        --helm-operator-params='--set helm.versions=v3'     \n        --cluster-type managedclusters")})))))},ae=n(175);function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function se(e){var t=e.entScale,n=e.setEntScale,a=e.featureFlag;return r.a.createElement(c.a,{horizontal:!0,tokens:{childrenGap:10}},r.a.createElement("img",{src:"aks.svg",alt:"Kubernetes Service",style:{width:"6%",height:"auto"}}),r.a.createElement(c.a,{tokens:{padding:10}},r.a.createElement(u.a,{variant:"xLarge"},"AKS Deploy helper"),r.a.createElement(u.a,null,"Tell us the requirements of your AKS deployment, and we will generate the configuration to create a full operational environment, incorporating best-practics guidence ")),r.a.createElement(c.a.Item,{tokens:{padding:10}},r.a.createElement(d.a,{label:r.a.createElement(u.a,{nowrap:!0},"Enterprise Scale"," ",r.a.createElement(p.a,{content:"use if you are following Enterprise Scale"},r.a.createElement(m.a,{iconName:"Info","aria-label":"Info tooltip"}))),onText:"Yes",offText:"No",checked:t,disabled:!a,onChange:function(e,t){return n(t)}})))}function ie(e){var t=e.config,n=Object(a.useState)(!1),o=Object(l.a)(n,2),s=o[0],u=o[1],d=Object(a.useState)("0"),p=Object(l.a)(d,2),h=p[0],b=p[1],v=t.tabLabels,k=t.defaults,E=t.entScaleOps,w=t.defaultOps;!function(e,t){Object(a.useEffect)((function(){var n=new Date,a="".concat(e,".").concat(t);return ue.startTrackPage(a),function(){console.log("exit screen ".concat(t," ").concat((new Date-n)/1e3)),ue.stopTrackPage(a,{"Component Name":e,Navigation:t},{mounttime:(new Date-n)/1e3})}}),[e,t])}("PortalNav",v[h]);var x=Object(a.useState)(Object.keys(k).reduce((function(e,t){return oe({},e,Object(i.a)({},t,[]))}),{})),S=Object(l.a)(x,2),C=S[0],A=S[1],z=Object(a.useState)(!1),I=Object(l.a)(z,2),N=I[0],O=I[1],D=Object(a.useState)(k),T=Object(l.a)(D,2),M=T[0],B=T[1];function G(e,t,n){B((function(a){return oe({},a,Object(i.a)({},e,oe({},a[e],Object(i.a)({},t,n))))}))}function K(e,t,n,a){var r=function(e,t){return C[e].find((function(e){return e.field===t}))}(e,t);!n&&r?A((function(n){return oe({},n,Object(i.a)({},e,n[e].filter((function(e){return e.field!==t}))))})):n&&!r&&A((function(n){return oe({},n,Object(i.a)({},e,n[e].concat({field:t,message:a})))}))}Object(a.useEffect)((function(){var e=window&&window.location.search;e&&(e.match("[?&]feature=([^&]+)")&&O(!0))}),[]),Object(a.useEffect)((function(){B((function(e){return oe({},e,{deploy:oe({},e.deploy,{clusterName:"az-k8s-".concat((Math.floor(9e5*Math.random())+1e5).toString(36))},{kubernetesVersion:"1.20.5"})})})),fetch("https://api.ipify.org?format=json").then((function(e){return e.json()})).then((function(e){B((function(t){return oe({},t,{deploy:oe({},t.deploy,{apiips:e.ip})})}))})).catch((function(e){return console.error("Problem fetching my IP",e)}))}),[]);var _=M.deploy,j=M.cluster,R=M.net,V=M.addons;function F(e,t,n){return r.a.createElement("span",null,C[e].length>0&&r.a.createElement(m.a,{iconName:"Warning12",style:{color:"red"}}),n(t))}return K("deploy","clusterName",!_.clusterName||null===_.clusterName.match(/^[a-z0-9][_\-a-z0-9]+[a-z0-9]$/i),"Enter valid cluster name"),K("cluster","osDiskType","Ephemperal"===j.osDiskType&&!Q.find((function(e){return e.key===j.vmSize})).eph,"Youre selected VM cache is not large enough to support Ephemeral. Select 'Managed' or a VM with a larger cache"),K("cluster","aad_tenant_id",j.enable_aad&&j.use_alt_aad&&36!==j.aad_tenant_id.length,"Enter Valid Directory ID"),K("addons","registry",(R.vnetprivateend||R.serviceEndpointsEnable)&&"Premium"!==V.registry&&"none"!==V.registry,"Premium Teir is required for Service Endpoints & Private Link, either select Premium, or disable Service Endpoints and Private Link"),K("deploy","apiips","whitelist"===j.apisecurity&&_.apiips.length<7,"Enter an IP/CIDR, or disable API Security in 'Cluster Details' tab"),K("addons","dnsZoneId",V.dns&&!V.dnsZoneId.match("^/subscriptions/[^/ ]+/resourceGroups/[^/ ]+/providers/Microsoft.Network/dnszones/[^/ ]+$"),"Enter valid Azure DNZ Zone resourceId"),K("addons","certEmail",V.certMan&&!V.certEmail.match("^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$"),"Enter valid email for cerfificate generation"),K("addons","kvId","akvExist"===V.csisecret&&!V.kvId.match("^/subscriptions/[^/ ]+/resourceGroups/[^/ ]+/providers/Microsoft.KeyVault/vaults/[^/ ]+$"),"Enter valid Azure DNZ Zone resourceId"),K("net","byoAKSSubnetId","byo"===R.vnet_opt&&!R.byoAKSSubnetId.match("^/subscriptions/[^/ ]+/resourceGroups/[^/ ]+/providers/Microsoft.Network/virtualNetworks/[^/ ]+/subnets/[^/ ]+$"),"Enter a valid Subnet Id where AKS nodes will be installed"),K("net","byoAGWSubnetId","byo"===R.vnet_opt&&"appgw"===V.ingress&&!R.byoAGWSubnetId.match("^/subscriptions/[^/ ]+/resourceGroups/[^/ ]+/providers/Microsoft.Network/virtualNetworks/[^/ ]+/subnets/[^/ ]+$"),"Enter a valid Subnet Id where Application Gateway is installed"),K("net","vnet_opt","default"===R.vnet_opt&&(R.serviceEndpointsEnable||R.afw||R.vnetprivateend),"Cannot use default networking of you select Firewall, Service Endpoints, or Private Link"),K("net","afw",R.afw&&"custom"!==R.vnet_opt,"byo"===R.vnet_opt?"Please de-select, when using Bring your own NVET, configure a firewall as part of your own VNET setup, (in a subnet or peered network)":"Template can only deploy Azure Firewall in single VNET with Custom Networking"),r.a.createElement("main",{id:"mainContent",className:"wrapper"},r.a.createElement(se,{entScale:s,setEntScale:u,featureFlag:N}),r.a.createElement(c.a,{verticalFill:!0,styles:{root:{width:"960px",margin:"0 auto",color:"grey"}}},r.a.createElement(P,{sections:s?E:w,updateCardValues:function(e,t){for(var n=(s?E:w).find((function(t){return t.key===e})).cards.find((function(e){return e.key===t})).values,a=function(){var a=o[r];console.log("updateCardValues(".concat(e,", ").concat(t,") -> ").concat(a)),B((function(e){return oe({},e,Object(i.a)({},a,oe({},e[a],{},Object.keys(n[a]).reduce((function(t,r){var o=n[a][r],s=Array.isArray(o)&&o.length>0&&"object"===typeof o[0]&&o[0].hasOwnProperty("set")?o.reduce((function(t,n){return void 0===t?n.page&&n.field?e[n.page][n.field]===n.value?n.set:void 0:n.set:t}),void 0):o;return console.log("updateCardValues: setting tab=".concat(a,", field=").concat(r," val=").concat(JSON.stringify(o)," targetVal=").concat(JSON.stringify(s))),oe({},t,Object(i.a)({},r,s))}),{}))))}))},r=0,o=Object.keys(n);r<o.length;r++)a()}}),r.a.createElement(g.a,{styles:{root:{marginTop:"55px !important",marginBottom:"5px"}}},r.a.createElement("b",null,"Deploy")," (optionally use 'Details' tabs for additional configuration)"),r.a.createElement(y.a,{selectedKey:h,onLinkClick:function(e){b(e.props.itemKey)}},r.a.createElement(f.a,{headerText:v.deploy,itemKey:"deploy",onRenderItemLink:function(e,t){return F("deploy",e,t)}},r.a.createElement(ne,{tabValues:M,updateFn:function(e,t){return G("deploy",e,t)},invalidArray:C.deploy,invalidTabs:Object.keys(C).filter((function(e){return C[e].length>0})).map((function(e){return"'".concat(v[e],"'")}))})),r.a.createElement(f.a,{headerText:v.cluster,itemKey:"cluster",onRenderItemLink:function(e,t){return F("cluster",e,t)}},r.a.createElement(X,{tabValues:M,updateFn:function(e,t){return G("cluster",e,t)},invalidArray:C.cluster})),r.a.createElement(f.a,{headerText:v.addons,itemKey:"addons",onRenderItemLink:function(e,t){return F("addons",e,t)}},r.a.createElement(H,{tabValues:M,updateFn:function(e,t){return G("addons",e,t)},invalidArray:C.addons})),r.a.createElement(f.a,{headerText:v.net,itemKey:"net",onRenderItemLink:function(e,t){return F("net",e,t)}},r.a.createElement(W,{tabValues:M,featureFlag:N,updateFn:function(e,t){return G("net",e,t)},invalidArray:C.net})))))}Object(ae.a)();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var le=n(174),ce=n(85);n.d(t,"appInsights",(function(){return ue})),n.d(t,"ConfigContext",(function(){return de}));var ue=new le.a({config:{instrumentationKey:"db40ec1e-0181-45dd-8fb8-525e07839cfa"}});ue.loadAppInsights();var de=r.a.createContext();s.a.render(r.a.createElement(de.Provider,{value:ce},r.a.createElement((function(){return r.a.createElement(de.Consumer,null,(function(e){return r.a.createElement(ie,{config:e})}))}),null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},85:function(e){e.exports=JSON.parse('{"tabLabels":{"deploy":"Deploy","cluster":"Cluster Details","addons":"Addon Details","net":"Networking Details"},"defaults":{"deploy":{"kubernetesVersion":"1.19.11","location":"WestEurope","apiips":"","demoapp":false,"disablePreviews":false},"cluster":{"apisecurity":"none","autoscale":false,"upgradeChannel":"none","count":2,"maxCount":20,"vmSize":"Standard_DS3_v2","osDiskSizeGB":0,"osDiskType":"Ephemperal","enable_aad":true,"use_alt_aad":false,"aad_tenant_id":"","enableAzureRBAC":true,"adminprincipleid":"","aadgroupids":"","availabilityZones":"no"},"addons":{"networkPolicy":"none","azurepolicy":"none","ingress":"none","ingressEveryNode":false,"certMan":false,"certEmail":"","dns":false,"dnsZoneId":"","registry":"none","podid":false,"podscale":false,"monitor":"none","retentionInDays":30,"csisecret":"none","kvId":"","gitops":"none"},"net":{"networkPlugin":"azure","afw":false,"vnetprivateend":false,"serviceEndpoints":[],"serviceEndpointsEnable":false,"vnet_opt":"default","byoAKSSubnetId":"","byoAGWSubnetId":"","vnet":"10.0.0.0/8","akssub":"10.240.0.0/16","ilbsub":"10.241.0.0/24","afwsub":"10.241.0.0/24","ersub":"10.242.0.0/24","agsub":"10.241.0.0/24","podCidr":"10.244.0.0/16","service":"10.0.0.0/16"}},"defaultOps":[{"key":"ops","sectionTitle":"Operations Principles","cards":[{"key":"none","title":"Simplest bare-bones cluster","description":{"title":"Just kubernetes please, I will make desisions later","bulets":[]},"icon":"Manufacturing","values":{"cluster":{"autoscale":false,"upgradeChannel":"none"},"addons":{"registry":"none","ingress":"none","monitor":"none"}}},{"key":"oss","title":"I prefer control & commuity opensource soltuions","description":{"title":"Use proven, opensource projects for my Kubernetes operational environment, and self-manage my clusters upgrades and scalling","bulets":[{"description":"Manual Upgrades"},{"description":"Manual Scalling"},{"description":"Nginx Ingress","linksrc":"https://kubernetes.github.io/ingress-nginx/"},{"description":"Promethous/Grahana Monitoring","linksrc":"https://coreos.com/operators/prometheus/docs/latest/user-guides/getting-started.html"},{"description":"Dockerhub container registry"}]},"icon":"DeveloperTools","values":{"cluster":{"autoscale":false,"upgradeChannel":"none"},"addons":{"registry":"none","ingress":"nginx","monitor":"oss"}}},{"key":"managed","default":true,"title":"I want a managed environment","description":{"title":"I\'d like my cluster to be auto-managed by Azure for upgrades and scalling, and use Azure provided managed addons to create an full environment with the minimum of operational requirements","bulets":[{"description":"Cluster auto-scaller","linksrc":"https://docs.microsoft.com/en-us/azure/aks/cluster-autoscaler"},{"description":"Cluser auto-upgrades","linksrc":"https://docs.microsoft.com/en-us/azure/aks/upgrade-cluster#set-auto-upgrade-channel"},{"description":"Azure Monitor for Containers","linksrc":"https://docs.microsoft.com/en-us/azure/azure-monitor/insights/container-insights-overview"},{"description":"Azure Container Registry"},{"description":"Azure AppGateway Ingress","linksrc":"https://docs.microsoft.com/en-gb/azure/application-gateway/ingress-controller-overview"}]},"icon":"Touch","values":{"cluster":{"autoscale":true,"upgradeChannel":"stable"},"addons":{"registry":[{"page":"net","field":"vnetprivateend","value":true,"set":"Premium"},{"page":"net","field":"serviceEndpointsEnable","value":true,"set":"Premium"},{"set":"Basic"}],"ingress":"appgw","monitor":"aci"}}}]},{"key":"secure","sectionTitle":"Security Principles","cards":[{"key":"low","title":"Simple cluster with no additional access limitations","description":{"title":"Simplest option for experimenting with kubernetes, or clusters with no sensitive data","bulets":[]},"icon":"Unlock","values":{"cluster":{"enable_aad":false,"apisecurity":"none"},"addons":{"networkPolicy":"none","registry":[{"page":"addons","field":"registry","value":"Standard","set":"Basic"},{"page":"addons","field":"registry","value":"Premium","set":"Basic"},{"set":"none"}],"azurepolicy":"none"},"net":{"serviceEndpointsEnable":false,"vnetprivateend":false,"afw":false}}},{"key":"normal","default":true,"title":"Custer with additional security controls","description":{"title":"Good option for implmenting recommended minimum security controls for regular environments","bulets":[{"description":"AAD Integration","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/managed-aad"},{"description":"AUDIT Pod security baseline standards","linksrc":"https://docs.microsoft.com/en-us/azure/governance/policy/concepts/policy-for-kubernetes"},{"description":"East-West traffic control","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/use-network-policies"},{"description":"Authorized IP address ranges","linksrc":"https://docs.microsoft.com/en-us/azure/aks/api-server-authorized-ip-ranges"},{"description":"Restrict dependencies with Service Endpoints **(ACR preview)","linksrc":"https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-service-endpoints-overview"}]},"icon":"Lock12","values":{"cluster":{"enable_aad":true,"apisecurity":"whitelist"},"addons":{"networkPolicy":"calico","registry":[{"page":"addons","field":"registry","value":"Basic","set":"Premium"},{"page":"addons","field":"registry","value":"Standard","set":"Premium"},{"page":"addons","field":"registry","value":"Premium","set":"Premium"},{"set":"none"}],"azurepolicy":"audit"},"net":{"vnet_opt":"custom","serviceEndpointsEnable":true,"serviceEndpoints":["Microsoft.ContainerRegistry"],"vnetprivateend":false,"afw":false}}},{"key":"private","title":"Private cluster with isolating networking controls","description":{"title":"Best option for high-secure, regulated environments or sensitive data requirements.","titleWarning":{"description":"WARNING: most complex environment option to operate","MessageBarType":5},"bulets":[{"description":"AAD Integration","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/managed-aad"},{"description":"ENFORCE Pod security baseline standards","linksrc":"https://docs.microsoft.com/en-us/azure/governance/policy/concepts/policy-for-kubernetes"},{"description":"East-West traffic control","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/use-network-policies"},{"description":"Private Cluster","linksrc":"https://docs.microsoft.com/en-us/azure/aks/private-clusters"},{"description":"Restrict dependencies with Private Link","linksrc":"https://docs.microsoft.com/en-us/azure/private-link/private-link-overview"},{"description":"Restrict egress with Azure firewall","linksrc":"https://docs.microsoft.com/en-us/azure/aks/limit-egress-traffic#restrict-egress-traffic-using-azure-firewall"},{"description":"Store Kubernetes Secrets in Azure Keyvault,","linksrc":"https://docs.microsoft.com/en-us/azure/aks/csi-secrets-store-driver"}]},"icon":"ProtectionCenterLogo32","values":{"cluster":{"enable_aad":true,"apisecurity":"private"},"addons":{"networkPolicy":"calico","registry":[{"page":"addons","field":"registry","value":"Basic","set":"Premium"},{"page":"addons","field":"registry","value":"Standard","set":"Premium"},{"page":"addons","field":"registry","value":"Premium","set":"Premium"},{"set":"none"}],"azurepolicy":"deny","csisecret":"akvNew"},"net":{"serviceEndpointsEnable":false,"vnetprivateend":true,"afw":true}}}]}],"entScaleOps":[{"key":"entscale","sectionTitle":"Enterprise Scale Environment Type","cards":[{"key":"disconnected","default":true,"title":"Disconnected Sandbox","description":{"title":"Provision a Disconnected enterprise scale complient sandbox enviroment, suitable for workloads that do not require connectivity, or networking hub peering controls","bulets":[{"description":"Cluster auto-scaller","linksrc":"https://docs.microsoft.com/en-us/azure/aks/cluster-autoscaler"},{"description":"Azure Monitor for Containers","linksrc":"https://docs.microsoft.com/en-us/azure/azure-monitor/insights/container-insights-overview"},{"description":"Azure AppGateway Ingress","linksrc":"https://docs.microsoft.com/en-gb/azure/application-gateway/ingress-controller-overview"},{"description":"AAD Integration","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/managed-aad"},{"description":"ENFORCE Pod security baseline standards","linksrc":"https://docs.microsoft.com/en-us/azure/governance/policy/concepts/policy-for-kubernetes"},{"description":"East-West traffic control","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/use-network-policies"},{"description":"Store Kubernetes Secrets in Azure Keyvault,","linksrc":"https://docs.microsoft.com/en-us/azure/aks/csi-secrets-store-driver"}]},"imageSrc":"./secure-baseline-architecture.svg","author":{"name":"Gordon Byers","initials":"GB","status":"Updated March, 2021"},"values":{"cluster":{"enable_aad":true,"apisecurity":"none","autoscale":true,"upgradeChannel":"none"},"addons":{"networkPolicy":"calico","registry":"Basic","azurepolicy":"deny","ingress":"appgw","monitor":"aci","csisecret":"akvNew"},"net":{"serviceEndpointsEnable":false,"vnetprivateend":false,"vnet_opt":"default","afw":false}}},{"key":"connected","default":true,"title":"Connected Sandbox","description":{"title":"Provision a enterprise scale complient sandbox enviroment into an EXISTING VNET, re-created with Firewall egress. Suitable for non-production workloads","titleWarning":{"description":"Requires existing Subnet, preconfigured with firewall egress","MessageBarType":5},"bulets":[{"description":"Cluster auto-scaller","linksrc":"https://docs.microsoft.com/en-us/azure/aks/cluster-autoscaler"},{"description":"Azure Monitor for Containers","linksrc":"https://docs.microsoft.com/en-us/azure/azure-monitor/insights/container-insights-overview"},{"description":"Azure Container Registry (with Private Link)"},{"description":"Azure AppGateway Ingress","linksrc":"https://docs.microsoft.com/en-gb/azure/application-gateway/ingress-controller-overview"},{"description":"AAD Integration","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/managed-aad"},{"description":"ENFORCE Pod security baseline standards","linksrc":"https://docs.microsoft.com/en-us/azure/governance/policy/concepts/policy-for-kubernetes"},{"description":"East-West traffic control","linksrc":"https://docs.microsoft.com/en-gb/azure/aks/use-network-policies"},{"description":"Private Cluster","linksrc":"https://docs.microsoft.com/en-us/azure/aks/private-clusters"},{"description":"Restrict dependencies with Private Link","linksrc":"https://docs.microsoft.com/en-us/azure/private-link/private-link-overview"},{"description":"Restrict egress with Azure firewall (provisioned & configured seperatly)","linksrc":"https://docs.microsoft.com/en-us/azure/aks/limit-egress-traffic#restrict-egress-traffic-using-azure-firewall"},{"description":"Store Kubernetes Secrets in Azure Keyvault,","linksrc":"https://docs.microsoft.com/en-us/azure/aks/csi-secrets-store-driver"}]},"imageSrc":"./secure-baseline-architecture.svg","author":{"name":"Gordon Byers","initials":"GB","status":"Updated March, 2021"},"values":{"cluster":{"enable_aad":true,"apisecurity":"private","autoscale":true,"upgradeChannel":"none"},"addons":{"networkPolicy":"calico","registry":"Premium","azurepolicy":"deny","ingress":"appgw","monitor":"aci","csisecret":"akvNew"},"net":{"serviceEndpointsEnable":false,"vnetprivateend":true,"vnet_opt":"byo","afw":false}}}]}]}')}},[[101,1,2]]]);
//# sourceMappingURL=main.1c2f7481.chunk.js.map